@if (!chargementEnCours && !erreur && guide) {
  <div class="conteneur-detail-guide">
    <header class="en-tete-guide">
      <button class="bouton-retour" (click)="retour()">
        ← Retour aux guides
      </button>
      <div class="conteneur-image-couverture">
        <img [src]="guide.imageCouverture || imageDefaut" [alt]="guide.titre" class="image-couverture" />
        <div class="voile-couverture">
          <h1 class="titre-guide-detail">{{ guide.titre }}</h1>
          @if (guide.destination) {
            <p class="destination-guide-detail">
              {{ guide.destination }}
            </p>
          }
        </div>
      </div>
    </header>

    <section class="bloc-informations-guide">
      <div class="carte-infos">
        <p class="description-guide-detail">{{ guide.description }}</p>
        <div class="metadonnees-guide">
          @if (guide.duree) {
            <span class="element-meta">
              <strong>Durée:</strong> {{ guide.duree }} jours
            </span>
          }
          <span class="element-meta">
            <strong>Nombre d'étapes:</strong> {{ guide.journees.length }}
          </span>
        </div>
      </div>
    </section>

    <section class="section-jours">
      <h2 class="titre-section">Itinéraire</h2>
      <div class="navigation-jours">
        @for (journee of guide.journees; track journee.id) {
          <button
            class="bouton-jour"
            [class.actif]="journeeSelectionnee?.id === journee.id"
            (click)="selectionnerJournee(journee)"
          >
            <span class="numero-jour">Jour {{ journee.numeroJour }}</span>
            <span class="titre-jour">{{ journee.titre }}</span>
          </button>
        }
      </div>
    </section>

    @if (journeeSelectionnee) {
      <section class="details-jour">
        <div class="en-tete-jour">
          <h2 class="titre-jour-important">
            Jour {{ journeeSelectionnee.numeroJour }}: {{ journeeSelectionnee.titre }}
          </h2>
          @if (journeeSelectionnee.description) {
            <p class="description-jour">
              {{ journeeSelectionnee.description }}
            </p>
          }
        </div>

        <div class="liste-activites">
          <h3 class="titre-activites">Activités de la journée</h3>
          @for (activite of obtenirActivitesTriees(); track activite.id; let i = $index) {
            <div class="carte-activite">
              <div class="numero-activite">{{ i + 1 }}</div>
              <div class="contenu-activite">
                <h4 class="titre-activite">{{ activite.titre }}</h4>
                <p class="description-activite">{{ activite.description }}</p>
                
                <div class="meta-activite">
                  @if (activite.heureDebut) {
                    <span class="horaire-activite">
                      {{ activite.heureDebut }}
                      @if (activite.heureFin) {
                        <span> - {{ activite.heureFin }}</span>
                      }
                    </span>
                  }
                  @if (activite.lieu) {
                    <span class="lieu-activite">
                      {{ activite.lieu }}
                    </span>
                  }
                </div>
              </div>
            </div>
          }

          @if (obtenirActivitesTriees().length === 0) {
            <div class="aucune-activite">
              Aucune activité prévue pour ce jour
            </div>
          }
        </div>
      </section>
    }
  </div>
}

@if (chargementEnCours) {
  <div class="bloc-chargement">
    <div class="animation-rotation"></div>
    <p>Chargement du guide...</p>
  </div>
}

@if (erreur) {
  <div class="bloc-erreur">
    <p>{{ erreur }}</p>
    <button (click)="retour()" class="bouton-retour-erreur">Retour aux guides</button>
  </div>
}
